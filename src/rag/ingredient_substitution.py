class IngredientSubstitutionSystem:
    def __init__(self):
        # 기본 대체 재료 데이터베이스
        self.substitution_db = {
            # 기본 채소류
            "양파": {
                "대체재료": ["파", "대파", "양파가루", "샬롯", "부추"],
                "대체비율": {
                    "파": "양파 1개 = 대파 1대",
                    "대파": "양파 1개 = 대파 1대",
                    "양파가루": "양파 1개 = 양파가루 1큰술",
                    "샬롯": "양파 1개 = 샬롯 2개",
                    "부추": "양파 1개 = 부추 1줌"
                },
                "특성": {
                    "파": "단맛이 덜하고 향이 강함",
                    "대파": "단맛이 덜하고 향이 강함",
                    "양파가루": "생양파보다 단맛이 약함",
                    "샬롯": "양파보다 달고 향이 섬세함",
                    "부추": "아삭한 식감과 마늘향 특징"
                }
            },
            "대파": {
                "대체재료": ["양파", "쪽파", "부추", "시금치", "청경채"],
                "대체비율": {
                    "양파": "대파 1대 = 양파 1/2개",
                    "쪽파": "대파 1대 = 쪽파 6~8개",
                    "부추": "대파 1대 = 부추 1묶음",
                    "시금치": "대파 1대 = 시금치 100g",
                    "청경채": "대파 1대 = 청경채 2개"
                },
                "특성": {
                    "양파": "단맛이 더 강하고 향이 순함",
                    "쪽파": "향이 비슷하고 크기가 작음",
                    "부추": "향이 강하고 식감이 다름",
                    "시금치": "향은 없지만 국물 맛을 냄",
                    "청경채": "아삭한 식감과 단맛"
                }
            },
            
            # 마늘/생강류
            "마늘": {
                "대체재료": ["마늘가루", "다진마늘", "마늘종", "마늘기름", "마늘페이스트"],
                "대체비율": {
                    "마늘가루": "마늘 1쪽 = 마늘가루 1/4작은술",
                    "다진마늘": "마늘 1쪽 = 다진마늘 1/2작은술",
                    "마늘종": "마늘 1쪽 = 마늘종 2개",
                    "마늘기름": "마늘 1쪽 = 마늘기름 1/2작은술",
                    "마늘페이스트": "마늘 1쪽 = 마늘페이스트 1/2작은술"
                },
                "특성": {
                    "마늘가루": "향은 약하나 오래 보관 가능",
                    "다진마늘": "신선한 마늘과 비슷한 맛",
                    "마늘종": "마늘향이 은은하고 식감이 아삭함",
                    "마늘기름": "기름에 마늘향이 배어있음",
                    "마늘페이스트": "신선한 마늘과 가장 비슷"
                }
            },
            "생강": {
                "대체재료": ["생강가루", "생강청", "생강즙", "갈은생강"],
                "대체비율": {
                    "생강가루": "생강 1쪽(1cm) = 생강가루 1/4작은술",
                    "생강청": "생강 1쪽 = 생강청 1작은술",
                    "생강즙": "생강 1쪽 = 생강즙 1/2작은술",
                    "갈은생강": "생강 1쪽 = 갈은생강 1/2작은술"
                },
                "특성": {
                    "생강가루": "향이 약하며 오래 보관 가능",
                    "생강청": "단맛이 있고 향이 부드러움",
                    "생강즙": "신선한 생강과 가장 비슷",
                    "갈은생강": "신선한 생강과 비슷하나 보관이 편리"
                }
            },

            # 고추/매운맛류
            "고추": {
                "대체재료": ["고춧가루", "청양고추", "홍고추", "피망", "할라피뇨"],
                "대체비율": {
                    "고춧가루": "풋고추 1개 = 고춧가루 1/2작은술",
                    "청양고추": "풋고추 1개 = 청양고추 1/2개",
                    "홍고추": "풋고추 1개 = 홍고추 1개",
                    "피망": "풋고추 1개 = 피망 1/2개",
                    "할라피뇨": "풋고추 1개 = 할라피뇨 1개"
                },
                "특성": {
                    "고춧가루": "매운맛 조절 용이",
                    "청양고추": "매운맛이 강함",
                    "홍고추": "단맛이 있고 매운맛이 적음",
                    "피망": "매운맛이 없고 달콤함",
                    "할라피뇨": "독특한 매운맛과 향"
                }
            },

            # 장류/양념
            "된장": {
                "대체재료": ["쌈장", "고추장", "미소된장", "청국장"],
                "대체비율": {
                    "쌈장": "된장 1큰술 = 쌈장 1큰술",
                    "고추장": "된장 1큰술 = 고추장 2/3큰술",
                    "미소된장": "된장 1큰술 = 미소된장 1.5큰술",
                    "청국장": "된장 1큰술 = 청국장 1큰술"
                },
                "특성": {
                    "쌈장": "매콤하고 달콤한 맛이 더해짐",
                    "고추장": "매운맛이 더해지고 달콤해짐",
                    "미소된장": "깔끔하고 부드러운 맛",
                    "청국장": "깊은 맛과 발효향이 강함"
                }
            },
            "간장": {
                "대체재료": ["국간장", "액젓", "소금", "맛간장"],
                "대체비율": {
                    "국간장": "진간장 1큰술 = 국간장 1.5큰술",
                    "액젓": "진간장 1큰술 = 액젓 1큰술",
                    "소금": "진간장 1큰술 = 소금 1/2작은술",
                    "맛간장": "진간장 1큰술 = 맛간장 1큰술"
                },
                "특성": {
                    "국간장": "색이 연하고 짠맛이 약함",
                    "액젓": "감칠맛이 더해짐",
                    "소금": "순수한 짠맛",
                    "맛간장": "달콤한 맛이 더해짐"
                }
            },

            # 식용유/기름류
            "식용유": {
                "대체재료": ["올리브유", "포도씨유", "들기름", "참기름", "버터"],
                "대체비율": {
                    "올리브유": "식용유 1큰술 = 올리브유 1큰술",
                    "포도씨유": "식용유 1큰술 = 포도씨유 1큰술",
                    "들기름": "식용유 1큰술 = 들기름 2/3큰술",
                    "참기름": "식용유 1큰술 = 참기름 1/2큰술",
                    "버터": "식용유 1큰술 = 버터 15g"
                },
                "특성": {
                    "올리브유": "고소하고 향이 있음",
                    "포도씨유": "담백하고 고온 조리 가능",
                    "들기름": "고소하고 향이 강함",
                    "참기름": "고소하고 향이 매우 강함",
                    "버터": "고소하고 부드러운 맛"
                }
            }
        }

    def get_substitutes(self, ingredient: str) -> dict:
        """주어진 재료의 대체재료 정보 반환"""
        if ingredient in self.substitution_db:
            return self.substitution_db[ingredient]
        return None

    def get_substitute_ratio(self, original: str, substitute: str) -> str:
        """원재료와 대체재료의 비율 반환"""
        if original in self.substitution_db:
            ratios = self.substitution_db[original]["대체비율"]
            return ratios.get(substitute, "정확한 대체 비율 정보가 없습니다.")
        return None

    def get_characteristics(self, original: str, substitute: str) -> str:
        """대체재료의 특성 정보 반환"""
        if original in self.substitution_db:
            characteristics = self.substitution_db[original]["특성"]
            return characteristics.get(substitute, "특성 정보가 없습니다.")
        return None

    def format_substitution_info(self, ingredient: str) -> str:
        """대체재료 정보를 포맷팅하여 반환"""
        info = self.get_substitutes(ingredient)
        if not info:
            return f"{ingredient}에 대한 대체재료 정보가 없습니다."
            
        result = f"[{ingredient}의 대체재료 정보]\n\n"
        result += "1. 대체 가능한 재료:\n"
        for sub in info["대체재료"]:
            result += f"- {sub}\n"
            result += f"  • 비율: {info['대체비율'][sub]}\n"
            result += f"  • 특성: {info['특성'][sub]}\n"
            
        return result